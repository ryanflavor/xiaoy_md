# Story 2.4.7: Optional Live Smoke Gate (Gated by Env)
**故事 2.4.7：可选 Live 冒烟 Gate（按环境开关）**

## Status
Approved

## Story
**As a** QA Engineer,
**I want** an optional live smoke test gated by environment variables,
**so that** we can quickly verify live connectivity and tick receipt without impacting CI.

## Acceptance Criteria
1. 仅当 `CTP_LIVE=1` 且全部 `CTP_*` 变量就绪时运行；否则 `pytest.skip`。
2. 绑定 `on_tick` 桥接，订阅基础 symbol，并在限定时间内收到至少一条 live tick。
3. 通过后产出/更新 Gate 文件：`docs/qa/gates/2.4.7-live-smoke.yml`，包含时间戳与结果。

## Tasks / Subtasks
- [ ] 复用/扩展 `tests/integration/test_ctp_live_adapter.py`：在启用时断言收到一条 tick（AC: 1, 2）
- [ ] 新增 Gate 文件 `docs/qa/gates/2.4.7-live-smoke.yml`，测试通过时写入 `status: PASS` 与时间戳（AC: 3）

## Dev Notes
- Ensure safe defaults: skip by default; bounded waits; clear diagnostics when skipped or failing.

## Dev Agent Record

### Agent Model Used
TBD

### Debug Log References
- Expect logs: connector attached, subscribed, first tick received.

### Completion Notes List
- TBD

### File List
- To be populated by Dev Agent during implementation

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-10 | 0.1 | Draft story created | Bob (Scrum Master) |
